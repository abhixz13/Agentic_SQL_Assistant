{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, AVG(total_price/quantity) AS price_per_unit, total_price/quantity AS metric FROM product_name WHERE sales_channel = 'Online' AND order_date >= 'start_of_last_quarter_date' AND order_date <= 'end_of_last_quarter_date' GROUP BY region ORDER BY metric DESC LIMIT 3;", "fixed_sql": "SELECT region, AVG(total_price/quantity) AS price_per_unit, total_price/quantity AS metric FROM product_sales WHERE sales_channel = 'Online' AND order_date >= 'start_of_last_quarter_date' AND order_date <= 'end_of_last_quarter_date' GROUP BY region ORDER BY metric DESC LIMIT 3;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, SUM(total_price) AS total_price FROM product_name GROUP BY region;", "fixed_sql": "SELECT region, SUM(total_price) AS total_price FROM product_sales GROUP BY region;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT category, COUNT(*) AS count FROM product_name GROUP BY category;", "fixed_sql": "SELECT category, COUNT(*) AS count FROM product_sales GROUP BY category;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_name WHERE region = '<val>' GROUP BY customer_id ORDER BY total_price DESC LIMIT 3;", "fixed_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_sales WHERE region = '<val>' GROUP BY customer_id ORDER BY total_price DESC LIMIT 3;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT category, COUNT(*) AS count FROM product_name GROUP BY category;", "fixed_sql": "SELECT category, COUNT(*) AS count FROM product_sales GROUP BY category;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_name WHERE region = '<val>' GROUP BY customer_id ORDER BY total_price DESC LIMIT 3;", "fixed_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_sales WHERE region = '<val>' GROUP BY customer_id ORDER BY total_price DESC LIMIT 3;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, SUM(total_price) AS total_price FROM product_name GROUP BY region;", "fixed_sql": "SELECT region, SUM(total_price) AS total_price FROM product_sales GROUP BY region;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT category, COUNT(*) AS count FROM product_name GROUP BY category;", "fixed_sql": "SELECT category, COUNT(*) AS count FROM product_sales GROUP BY category;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_name WHERE region = '<val>' GROUP BY customer_id ORDER BY total_price DESC LIMIT 3;", "fixed_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_sales WHERE region = '<val>' GROUP BY customer_id ORDER BY total_price DESC LIMIT 3;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, SUM(total_price) AS total_price FROM product_name GROUP BY region;", "fixed_sql": "SELECT region, SUM(total_price) AS total_price FROM product_sales GROUP BY region;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_name GROUP BY customer_id;", "fixed_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_sales GROUP BY customer_id;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "syntax", "question": null, "bad_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_sales GROUP BY customer_id LIMIT 20 ORDER BY total_price DESC;", "fixed_sql": "SELECT customer_id, SUM(total_price) AS total_price FROM product_sales GROUP BY customer_id ORDER BY total_price DESC LIMIT 20;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, AVG(price_per_unit) AS price_per_unit FROM product_name WHERE order_date >= 'last quarter start date' AND order_date <= 'last quarter end date' GROUP BY region;", "fixed_sql": "SELECT region, AVG(price_per_unit) AS price_per_unit FROM product_sales WHERE order_date >= 'last quarter start date' AND order_date <= 'last quarter end date' GROUP BY region;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, AVG(price_per_unit) AS price_per_unit FROM product_name WHERE order_date >= date('now','start of month','-3 months') AND order_date < date('now','start of month') GROUP BY region;", "fixed_sql": "SELECT region, AVG(price_per_unit) AS price_per_unit FROM product_sales WHERE order_date >= date('now','start of month','-3 months') AND order_date < date('now','start of month') GROUP BY region;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, strftime('%Y', order_date) AS year, SUM(total_price) AS total_price FROM product_name WHERE order_date > '2000-01-01' GROUP BY region, year;", "fixed_sql": "SELECT region, strftime('%Y', order_date) AS year, SUM(total_price) AS total_price FROM product_sales WHERE order_date > '2000-01-01' GROUP BY region, year;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, SUM(total_price) AS total_revenue FROM product_name WHERE total_price < previous_year_total_price GROUP BY region;", "fixed_sql": "SELECT region, SUM(total_price) AS total_revenue FROM product_sales WHERE total_price < previous_year_total_price GROUP BY region;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, SUM(total_price) AS total_revenue FROM product_sales WHERE total_price < previous_year_total_price GROUP BY region;", "fixed_sql": "SELECT region, SUM(total_price) AS total_revenue FROM product_sales WHERE total_price < SUM(total_price) OVER (PARTITION BY region) GROUP BY region;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
{"failure_type": "schema", "question": null, "bad_sql": "SELECT customer_id, COUNT(*) AS count FROM product_name GROUP BY customer_id LIMIT 20;", "fixed_sql": "SELECT customer_id, COUNT(*) AS count FROM product_sales GROUP BY customer_id LIMIT 20;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}

{"failure_type": "schema", "question": null, "bad_sql": "SELECT region, AVG(total_price/quantity) AS price_per_unit, total_price/quantity AS metric FROM product_name WHERE sales_channel = 'Online' AND order_date >= 'start_of_last_quarter_date' AND order_date <= 'end_of_last_quarter_date' GROUP BY region ORDER BY metric DESC LIMIT 3;", "fixed_sql": "SELECT region, AVG(total_price/quantity) AS price_per_unit, total_price/quantity AS metric FROM product_sales WHERE sales_channel = 'Online' AND order_date >= 'start_of_last_quarter_date' AND order_date <= 'end_of_last_quarter_date' GROUP BY region ORDER BY metric DESC LIMIT 3;", "ask_myself": ["Do all referenced tables/columns exist in the schema?", "If SELECT mixes aggregates + non-aggregates, did I add GROUP BY?", "Are aggregates applied to numeric fields?", "Does top-N include ORDER BY metric DESC and LIMIT N?"]}
